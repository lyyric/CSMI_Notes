
$$
\frac{\partial u}{\partial t} - \frac{\partial^2 u}{\partial x^2} = 0
$$

$$
\frac{\partial u(0,t)}{\partial x} = \frac{\partial u(L,t)}{\partial x} = 0
$$

$$
u(x,0) = u_0(x)
$$

$$
u^m = \begin{pmatrix} u_0^m \\ u_1^m \\ \vdots \\ u_{N-1}^m \end{pmatrix}
$$

$$
A = \begin{pmatrix} 1 & -1 & 0 & \cdots & 0 \\ -1 & 2 & -1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & \cdots & -1 & 2 & -1 \\ 0 & \cdots & 0 & -1 & 1 \end{pmatrix}
$$

$$
U^{m+1} - U^m + \frac{1}{h^2} AU^m = 0
$$

Explicite:

$$
U^{m+1} - U^m + \frac{1}{h^2} AU^{m+1} = 0
$$

$$
\frac{U^{m+1} - U^m}{\tau} + \frac{1}{h^2} AU^{n+1} = 0 \quad \text{(implicite)}
$$

3) Quelques propriétés mathématiques :

$$
u(x,t) = c_0 + \sum_{i=1}^{\infty} c_i e^{-\frac{i^2 \pi^2 t}{L^2}} \cos\left(\frac{i \pi x}{L}\right)
$$

$$
c_0 = \frac{1}{L} \int_0^L u(x,0) dx
$$

$$
c_i = \frac{2}{L} \int_0^L u(x,0) \cos\left(\frac{i \pi x}{L}\right) dx \quad \text{pour} \quad i \geq 1
$$

$$
u_0(x) \in L^2([0,L])
$$

$$
\|f\|^2 = \int_0^L f^2 dx
$$

$$
|c_0| = \left| \langle u_0, e_0 \rangle \right| \leq \|u_0\|
$$

$$
|c_i| = \frac{2}{L} \left| \langle u_0, e_i \rangle \right| \leq \frac{2}{L} \|u_0\| = C
$$

$$
f_i = x \mapsto c_i e^{-\frac{i^2 \pi^2 t}{L^2}} \cos\left(\frac{i \pi x}{L}\right)
$$

$$
f_i \text{ est continue, et à } t \text{ fixé }
$$

$$
\|f_i\|_{\infty} = |c_i| e^{-\frac{i^2 \pi^2 t}{L^2}} \leq C e^{- \frac{i^2\pi^2 t}{L^2}}
$$

Espace $E = \left\{ f \in C^0([0,L]) \; | \; \|f\| < +\infty \right\}$

La série $\sum f_i$ converge uniformément dans $E$ pour $t > 0$.

$$
u(x,t) = \sum_{i=1}^{\infty} f_i(x,t)
$$

Question:

$$
\frac{\partial u}{\partial t} - \frac{\partial^2 u}{\partial x^2} = 0 ?
$$

La réponse est **oui** lorsque la série des dérivées converge.


$$
\partial_t^\alpha \partial_t^\beta f_i(x,t) = e^{-\frac{i^2 \pi^2 t}{L^2}} \times R_i(x,t)
$$

$$
R_i(x,t) = \text{puissance de } i^2
$$

$$
\times \sin\left(\frac{i \pi x}{L}\right) \quad \text{ou bien des} \quad \cos\left(\frac{i \pi x}{L}\right)
$$

$$
|R_i(x,t)| \leq P(t)
$$

$$
P \text{ est un polynôme}
$$

$$
\|\partial_t^\alpha \partial_t^\beta f_i(x,t)\|_\infty \leq e^{-\frac{i^2 \pi^2 t}{L^2}} P(t)
$$

Conclusion : on a encore une série de fractions normalement convergente pour $\| \cdot \|_{\infty}$.

On peut dériver sous le signe $\sum$ autant de fois que nécessaire, $t \geq t_0 > 0$.

$$
u(x,t) \text{ est de classe } \infty \text{ pour } t > 0
$$

Et on a bien :

$$
\frac{\partial u}{\partial t} - \frac{\partial^2 u}{\partial x^2} = 0
$$

$$
t = 0
$$

$$
c_0 + \sum_{i=1}^{\infty} c_i \cos\left(\frac{i \pi x}{L}\right) = u_0(x)
$$

$$
u_0 \in L^2 \quad \text{on a convergence dans} \; l^2
$$

(Théorie des séries de Fourier)


Si $u_0$ est de classe $C^2$ et $u_0'(L) = u_0'(0) = 0$

$$
c_i = \frac{2}{L} \int_0^L u_0(x) \cos\left(\frac{i \pi x}{L}\right) dx \quad i \geq 1
$$
$$
= - \frac{2}{L} \int_0^L u_0'(x) \frac{L}{i \pi} \sin\left(\frac{i \pi x}{L}\right) dx + \frac{2}{L} \left[ u_0(x) \frac{L}{i \pi} \sin\left(\frac{i \pi x}{L}\right) \right]_0^L
$$

$$
= - \frac{2}{L} \int_0^L \left( u_0''(x) \frac{L^2}{i^2 \pi^2} \cos\left(\frac{i \pi x}{L}\right) \right) dx
$$

$$
+ \frac{2}{L} \left[ \frac{u_0'(x)}{\cos\left(\frac{i \pi x}{L}\right)} \right]_0^L
$$

$$
c_i = -\frac{2}{L \pi^2 i^2} \int_0^L u_0''(x) \cos\left(\frac{i \pi x}{L}\right) dx
$$

$$
|c_i| \leq \frac{2}{L \pi^2 i^2} \| u_0'' \|
$$

Terme général d'une série $CV$, donc $\sum c_i$ est uniformément convergente.

$$
\frac{\partial u}{\partial t} - \frac{\partial^2 u}{\partial x^2} = 0
$$

Propriétés de la solution (quand elle est assez régulière) :

Conservation :

$$
M(t) = \int_0^L u(x,t) dx
$$

$$
\frac{dM(t)}{dt} = \int_0^L \frac{\partial u}{\partial t}(x,t) dx
$$

$$
= \int_0^L \frac{\partial^2 u}{\partial x^2}(x,t) dx
$$

$$
= \left[ \frac{\partial u}{\partial x}(x,t) \right]_0^L = 0
$$

(à cause des conditions aux limites)

Donc :

$$
\frac{dM(t)}{dt} = 0
$$

Donc :

$$
M(t) = M(0) = L c_0
$$

**Décroissance de l'énergie :**

$$
E(t) = \frac{1}{2} \int_0^L u^2(x,t) dx
$$

$$
\frac{dE(t)}{dt} = \frac{1}{2} \int_0^L \partial_t u^2(x,t)  dx
$$

$$
= \int_0^L u(x,t) \partial_t u(x,t) dx
$$

$$
= \int_0^L u(x,t) \frac{\partial^2 u}{\partial x^2}(x,t) dx
$$

$$
= - \int_0^L \left( \frac{\partial u}{\partial x}(x,t) \right)^2 dx + \left[ u \frac{\partial u}{\partial x} \right]_0^L
$$

donc, 

$$
\frac{dE(t)}{dt} \leq 0
$$

$$
E(t) \leq E(0)
$$

**Traduction sur le schéma** :

$$
u_i^n = u(x_i, t_n)
$$

$$
\begin{cases}
x_i = ih + \frac{h}{2} \\
t_n = n \tau
\end{cases}
$$
$$
M^m = h \sum_{i=0}^{N-1} u_i^n
$$

(Approximation $\int u(x,t)$ par la méthode des rectangles)

$$
U^n = \begin{pmatrix} u_0^n \\ \vdots \\ u_{N-1}^n \end{pmatrix}
$$

$$
M^n = h(1, \dots, 1) U^n
$$

$$
U^{n+1} = \left(I - \frac{\tau}{h^2} A \right) U^n
$$

$$
\begin{pmatrix} 1 & -1 & 0 & \cdots & 0 \\ -1 & 2 & -1 & \cdots & 0 \\ 0 & -1 & 2 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & \cdots & 0 & -1 & 1 \end{pmatrix}
$$

$$
(1, \dots, 1) \begin{pmatrix} 0 \\ 0 \\ \vdots \\ 0 \end{pmatrix}
$$

$$
(1, \dots, 1) A = \begin{pmatrix} 0 \\ \vdots \\ 0 \end{pmatrix}
$$

$$
(1, \dots, 1) U^{n+1} = (1, \dots, 1) U^n
$$

$$
M^{n+1} = M^n
$$

$$
U^{n+1} - U^n + \frac{\tau}{h^2} A U^{n+1} = 0 \quad \text{(schéma implicite)}
$$

$$
(1, \dots, 1) \quad \text{à gauche}
$$

$$
M^{n+1} - M^n = 0
$$

Les schémas implicite et explicite conservent la masse.

$$
E^n = \frac{h}{2} \sum_{i=0}^{N-1} (u_i^n)^2 \sim E(t^n)
$$

$$
E^n = \frac{h}{2} \| U^n \|_2^2
$$

**Théorème de von Neumann, Lax** :
Dit que la solution discrète converge vers la solution exacte quand $(h, \tau) \rightarrow (0,0)$, si le schéma est stable :

$$
\forall m, \quad E^{n+1} \leq E^n
$$

**Calcul des valeurs propres et vecteurs propres de** $A$ :

$$
A e_k = \lambda_k e_k
$$

$\lambda_k$ : valeurs propres de $A$  
$e_k$ : vecteurs propres

$$
A V = \lambda V
$$

$$
A = \begin{pmatrix} 
1 & -1 & 0 & \cdots & 0 \\ 
-1 & 2 & -1 & \cdots & 0 \\ 
0 & -1 & 2 & \cdots & 0 \\ 
\vdots & \vdots & \vdots & \ddots & \vdots \\ 
0 & \cdots & 0 & -1 & 1 
\end{pmatrix}
$$

$$
V = \begin{pmatrix} 
V_0 \\ 
\vdots \\ 
V_{N-1} 
\end{pmatrix}
$$

$$
v_0 - v_1 = \lambda v_0
$$

$$
-v_0 + 2v_1 - v_2 = \lambda v_1
$$

$$
-v_{i-1} + 2v_i - v_{i+1} = \lambda v_i
$$

$$
-v_{N-2} + 2v_{N-1} - v_N = \lambda v_{N-1}
$$

$$
-v_{N-1} + 2v_N - v_{N+1} = \lambda v_N
$$

**Convention :**
$$
\begin{cases}
v_{-1} = v_0 \\
v_N = v_{N-1}
\end{cases}
$$

$$
V_i = \cos(k \pi x_i)
$$

$$
V_{-1} = \cos\left(k \pi (-\frac{h}{2})\right)
$$

$$
? = \cos\left(k \pi \frac{h}{2}\right)
$$

Avec : $L=1$

$$
h = \frac{L}{N} = \frac{1}{N}
$$

$$
x_i = ih + \frac{h}{2}
$$

de même

$$
V_{N-1} = V_N
$$

$$
-\cos(k \pi x_{i-1}) + 2 \cos(k \pi x_i) - \cos(k \pi x_{i+1})
$$

$$
\cos(p) \cos(q) = 2 \cos\left(\frac{p+q}{2}\right) \cos\left(\frac{p-q}{2}\right)
$$

$$
2 \cos(k \pi x_i) - 2 \cos\left(k \pi \frac{x_{i+1} + x_{i-1}}{2}\right) \cos\left(k \pi \frac{x_{i+1} - x_{i-1}}{2}\right)
$$

$$
= 2 \cos(k \pi x_i) - 2 \cos(k \pi x_i) \cos(k \pi h)
$$

$$
= 2 \cos(k \pi x_i) \cdot 2 (1 - \cos(k \pi h))
$$

$$
= v_i \cdot 4 \sin^2\left(\frac{k \pi h}{2}\right)
$$
car, 
$$
\cos(2p) = 1 - 2 \sin^2(p)
$$

$$
\begin{cases}
v_i^{(k)} = \cos(k \pi x_i), \quad k = 0, \dots, N-1 \\
\lambda_k = 4 \sin^2\left(\dfrac{k \pi h}{2}\right)
\end{cases}
$$

$$
\lambda_0 = 0
$$

$$
\lambda_k > 0 \quad \text{pour} \quad k = 1, \dots, N-1
$$

$A$ est une matrice symétrique :

$$
A \geq 0
$$

$$
v^{(0)} = \begin{pmatrix} 1 \\ \vdots \\ 1 \end{pmatrix}
$$

$$
\ker(A) = \text{vect} \, v^{(0)} \quad \text{de dimension 1}
$$

Stabilité du schéma implicite :

$$
\left\{ v^{(k)}, \quad k = 0, \dots, N-1 \right\} \quad \text{base orthogonale de} \, \mathbb{R}^N
$$

$$
\left\{ e^{(k)}, \quad k = 0, \dots, N-1 \right\} \quad \text{BON de vecteurs propres de} \, A
$$

$$
\beta = \frac{\tau}{h^2} \leq \frac{1}{2}
$$

Condition suffisante pour la stabilité du schéma explicite :

$$
U^{n+1} = \left(I - \frac{\tau}{h^2} A\right) U^n
$$

$$
\|U^{n+1}\| \leq \|U^n\| \quad ?
$$

$$
\|U^{n+1}\| \leq \left\|I - \frac{\tau}{h^2} A\right\| \|U^n\|
$$

$$
\|A\| = \sup_{\|x\| \neq 0} \frac{\|Ax\|}{\|x\|}
$$

$$
\|M\| = \sqrt{\rho(M^T M)}
$$

Si $M$ est symétrique :

$$
\|M\| = \rho(M)=\max_k |\mu_k|
$$

$\mu_k$ : valeurs propres de $M$

$$
M = I - \frac{\tau}{h^2} A
$$

$e^{(k)}$ sont vecteurs propres de $M$ :

$$
\mu_k = 1 - \frac{\tau}{h^2} 4 \sin^2\left(\frac{k \pi}{2N}\right), \quad k = 0, \dots, N-1
$$


$$
1 - \frac{4\tau}{h^2} \leq \mu_k \leq 1
$$

$$
\frac{\tau}{h^2} \leq \frac{1}{2}
$$

Donc :

$$
-1 \leq \mu_k \leq 1
$$

Donc :

$$
\rho(M) \leq 1
$$

Donc, le schéma est stable.

$$
U^{n+1} = \left(I + \frac{\tau}{h^2} A\right)^{-1} U^n
$$

$$
\left\|\left(I + \frac{\tau}{h^2} A\right)^{-1}\right\| \leq 1 \quad ?
$$

$$
M = \left(I + \frac{\tau}{h^2} A\right)^{-1}
$$

$$
\mu_k = \frac{1}{1 + \dfrac{\tau}{h^2} 4 \sin^2\left(\dfrac{k \pi}{2N}\right)}
$$

On voit que :

$$
0 \leq \mu_k \leq 1
$$

Indépendamment de $\beta = \dfrac{\tau}{h^2}$

Donc :

$$
\rho(M) \leq 1
$$

Le schéma implicite est inconditionnellement stable.

**θ-schéma (Crank-Nicolson)** :

$$
(1 - \theta) \times \frac{U^{n+1} - U^n}{\tau} + \frac{A}{h^2} U^n = 0
$$

$$
\theta \times \frac{U^{n+1} - U^n}{\tau} + \frac{A}{h^2} U^{n+1} = 0
$$

$$
\frac{U^{n+1} - U^n}{\tau} + \frac{\tau A}{h^2} \theta \, U^{n+1} + \frac{\tau A}{h^2} (1 - \theta) \, U^n = 0
$$

$$
\left(I + \theta \frac{\tau A}{h^2}\right) U^{n+1} = \left(I - (1 - \theta) \frac{\tau A}{h^2}\right) U^n
$$

$$
\theta = 0 \quad \text{(schéma explicite)}
$$

$$
\theta = 1 \quad \text{(schéma implicite)}
$$

$$
\theta = \frac{1}{2} \quad \text{(Crank-Nicolson)}
$$

$$
\left(I + \frac{\tau A}{2 h^2}\right)U^{n+1} = \left(I - \frac{\tau A}{2 h^2}\right) U^n
$$

$$
U^{n+1} = M U^n
$$

$$
M = \left(I + \frac{\tau A}{2 h^2}\right)^{-1} \left(I - \frac{\tau A}{2 h^2}\right)
$$

$$
\mu_k = \frac{1 - \frac{\tau}{2h^2} 4 \sin^2\left(\frac{k \pi}{2N}\right)}{1 + \frac{\tau}{2h^2} 4 \sin^2\left(\frac{k \pi}{2N}\right)}=\frac{1 - x}{1 + x}
$$

Avec $x \geq 0$.

$$
0 \leq \mu_k \leq 1
$$

Donc, le schéma est inconditionnellement stable.

$$
\partial_t u(x_i, t_n + \frac{\tau}{2}) - \partial_{xx} u(x_i, t_n + \frac{\tau}{2}) = 0
$$

$$
\frac{u(x_i, t_{n+1}) - u(x_i, t_n)}{\tau} = \partial_{xx} \left(\frac{u(x_i, t_{n+1}) + u(x_i, t_n)}{2}\right) + O(\tau^2)
$$

$$
\partial_{xx} \left( \frac{u(x_i, t_{m+1}) + u(x_i, t_m)}{2} \right) = \frac{u(x_{i+1}, t_{m+1}) - 2 u(x_i, t_{m+1}) + u(x_{i-1}, t_{m+1})}{h^2}
$$

$$
+ \frac{1}{2h^2} \left( u(x_{i+1}, t_m) - 2u(x_i, t_m) + u(x_{i-1}, t_m) \right) = -R
$$


Il y a $R$

$$
au \ point \ (x_i, t_m + \frac{\tau}{2})
$$

$$
= \dots \partial_{xx} u(x_i, t_m + \frac{\tau}{2})
$$

$$
+ O(\tau^2) + O(h^2)
$$
