**Calcul scientifique**  1

I) Résolution numérique de l'équation de la chaleur  
(ou équation de diffusion)

1) Méthode de développement en série  

Inconnue $u(x,t)$  

Concentration de sucre dans un café
$$
\begin{cases}
x \in [0, L],\quad L > 0\\
t \geq 0
\end{cases}
$$
$x$ espace  
$t$ temps  

$u(x,0) = u_0(x)$  

$u_0$, fonction donnée.

$\frac{\partial u}{\partial x}$ dérivée partielle de $u$ / $x$  

$\frac{\partial u}{\partial t}$ dérivée partielle de $u$ / $t$  

$\frac{\partial u}{\partial x} = \partial_x u = u_x$

$\frac{\partial^2 u}{\partial x^2} = \partial_{xx} u = u_{xx}$

Équation de diffusion

a) $\forall (x,t) \in [0,L] \times [0,+\infty[$  

$$
\frac{\partial u}{\partial t} (x,t) - \frac{\partial^2 u}{\partial x^2} (x,t) = 0
$$  
b) $u(x,0) = u_0(x)$, $x \in [0,L]$  

c) $\frac{\partial u}{\partial x} (0,t) = \frac{\partial u}{\partial x} (L,t) = 0$  

(étanchéité)

Solutions de a) et c)

$u_i(x,t) = \cos \left( \frac{i \pi x}{L} \right) \exp \left( - \frac{i^2 \pi^2 t}{L^2} \right)$  

$i \in \mathbb{N}$  

$\partial_t u_i - \partial_{xx} u_i = 0$  

$\partial_x u_i = \exp \left( - \frac{i^2 \pi^2 t}{L^2} \right) \frac{\pi}{L} \sin \left( \frac{\pi x}{L} \right)$  

$\partial_x u_i(0,t) = 0$  

$\partial_x u_i(L,t) = 0$  

Ex0

$u(x,t) = v(x) g(t)$  
On cherche $v$ et $g$

$\partial_t u - \partial_{xx} u = 0+ cL$

$u(x,t) = \sum_{i=0}^{+\infty} C_i u(x,t)$

$u$ est solution (faible) de a) et c)

Fourier.

b) $u(x,0) = u_0(x)$

$u(x,0) = \sum_{i=0}^{+\infty} C_i \cos\left( \frac{i \pi x}{L} \right)$

$\tilde{v}_i (x) = \cos \left( \frac{i \pi x}{L} \right)$

Prop. la famille $\left( \tilde{v}_i \right)_{i=0, \dots, \infty}$ est une famille orthogonale pour le produit scalaire de $L^2([0,L])$

dém. $\langle u, v \rangle = \int_0^L u(x) v(x) dx$

$\int_0^L \tilde{v}_i(x) \tilde{v}_j(x) dx$

$= \int_0^L \cos\left( \frac{i \pi x}{L} \right) \cos\left( \frac{j \pi x}{L} \right) dx$

($\cos p \cos q = \frac{1}{2} \left[ \cos \frac{p+q}{2} + \cos \frac{p-q}{2} \right]$)

$= \int_0^L \frac{1}{2} \left[ \cos \frac{(i+j) \pi x}{2L} + \cos \frac{(i-j) \pi x}{2L} \right] dx$

$i = j =0 \Rightarrow \langle \tilde{v}_i, \tilde{v}_j \rangle = L$

$i \neq j \neq 0 \Rightarrow \langle \tilde{v}_i, \tilde{v}_j \rangle = L/2$

$i \neq j \Rightarrow \langle \tilde{v}_i, \tilde{v}_j \rangle$

$= \frac{1}{2} \left[ \frac{2L}{(i+j) \pi} \sin \left( \frac{(i+j) \pi x}{2L} \right) \right]_0^L$

$+ \frac{1}{2} \left[ \frac{2L}{(i-j) \pi} \sin \left( \frac{(i-j) \pi x}{2L} \right) \right]_0^L$

$= 0$

$\| v \|_{L^2([0,L])} = \sqrt{\langle v, v \rangle}$

$\langle \tilde{v}_0, \tilde{v}_0 \rangle = L$

$\Rightarrow \| \tilde{v}_0 \| = \sqrt{L}$

$\langle \tilde{v}_i, \tilde{v}_i \rangle = \frac{L}{2}$ \ \ $i \neq 0$

$\Rightarrow \| \tilde{v}_i \| = \sqrt{\frac{L}{2}}$

$v_i = \frac{1}{\| \tilde{v}_i \|} \tilde{v}_i$

$$
v_i(x) = \begin{cases} 
\frac{1}{\sqrt{L}} & i = 0 \\ 
\sqrt{\frac{2}{L}} \cos\left( \frac{i \pi x}{L} \right) & i \neq 0 
\end{cases}
$$

**Bon**

$u_0 = \sum C_i \tilde{v}_i$

$= \sum C_i \| \tilde{v}_i \| v_i$

$\langle u(\cdot,0), v_j \rangle = \langle \sum C_i \| \tilde{v}_i \| v_i, v_j \rangle$

$= \sum C_i \| \tilde{v}_i \| \langle v_i, v_j \rangle$

$= C_j \| \tilde{v}_j \|$

$C_i = \dfrac{1}{\| \tilde{v}_i \|} \langle u(\cdot,0), \tilde{v}_i \rangle$

$i = 0$

$C_0 = \frac{1}{L} \int_0^L u(x,0) dx$

$i \neq 0$

$C_i = \frac{2}{L} \int_0^L u(x,0) \cos \left( \frac{i \pi x}{L} \right) dx$

2) Méthode de différences finies.

Approximation des dérivées partielles par des opérateurs en dimension finie $N$ entier positif.

```tikz
\begin{document}
\begin{tikzpicture}[domain=-5:5] 
    % 设置坐标轴
    \draw[->] (-0.3, 0) -- (4.4, 0);
    \draw (0,1.7) -- (0,-1.7)node[below] {$x=0$};
    \draw (4,1.7) -- (4,-1.7)node[below] {$x=L$};
    \draw (1,0.7) -- (1,-0.7);
    \draw (2,0.7) -- (2,-0.7);
    \draw (3,0.7) -- (3,-0.7);    
\end{tikzpicture}
\end{document}
```

$\Delta x = h = \frac{L}{N}$ pas d’espace  

$x_i = i \Delta x + \frac{\Delta x}{2}$, $i = 0, \dots, N-1$  

$t_n = n \Delta t$  

$\Delta t$ : pas de temps  

$u(x_i, t_n) \simeq u_i^n$  

$u_i^0 = u(x_i, 0)$  

Approximation de $u_{xx}$ et $u_t$ :

$f(x + h) = f(x) + h f'(x) + \frac{h^2}{2} f''(x) + \frac{h^3}{6} f^{(3)}(x) + O(h^4)$  

$f(x - h) = f(x) - h f'(x) + \frac{h^2}{2} f''(x) - \frac{h^3}{6} f^{(3)}(x) + O(h^4)$

$f(x+h) + f(x-h)$

$= 2f(x) + h^2 f''(x) + O(h^4)$

$f''(x) = \frac{f(x-h) - 2 f(x) + f(x+h)}{h^2} + O(h^2)$

$f''(x_i) = \frac{f(x_{i-1}) - 2 f(x_i) + f(x_{i+1})}{h^2} + O(h^2)$

$\Delta t = \tau$

$g(t+\tau) = g(t) + \tau g'(t) + O(\tau^2)$

$g'(t) = \frac{g(t+\tau) - g(t)}{\tau} + O(\tau)$

(Question pour plus tard) comment poser à $O(\tau^2)$ ?

$g'(t+\tau) = \frac{g(t+\tau) - g(t)}{\tau} + O(\tau)$

$g'(t_n) = \frac{g(t_{n+1}) - g(t_n)}{\tau}$

ou $g'(t_{n+1}) = \frac{g(t_{n+1}) - g(t_n)}{\tau}$

---

Différences finies décentrées :

$g(t) = g(t + \tau - \tau)$

$= g(t+\tau) - \tau g'(t+\tau) + O(\tau^2)$

$g'(t+\tau) = \frac{g(t+\tau) - g(t)}{\tau} + O(\tau)$

$u_{xx}(x_i, t_n) \longrightarrow \dfrac{u_{i-1}^n - 2u_i^n + u_{i+1}^n}{h^2}$

$u_t(x_i, t_n) \longrightarrow \dfrac{u_i^{n+1} - u_i^n}{\tau}$

$\left( \Delta u \dfrac{u_i^n - u_{i-1}^n}{\tau} \right)$

$\frac{u_i^{n+1} - u_i^n}{\tau} + \frac{- u_{i-1}^n + 2 u_i^n - u_{i+1}^n}{h^2} = 0$

$u_i^{n+1} = u_i^n - \frac{\tau}{h^2} \left( - u_{i-1}^n + 2 u_i^n - u_{i+1}^n \right)$

---

**Schéma explicite.**

Problems aux bords :

$i = 0$ il manque $u_{-1}^n$  

$i = N - 1$ il manque $u_N^n$

$\frac{\partial u}{\partial x} \bigg|_{x = 0} = 0$

$f'(x) \bigg|_{x=0} = \frac{f(x_1) - f(x_0)}{h}$

$= \frac{f(\frac{h}{2}) - f(- \frac{h}{2})}{h} + O(h^2)$

$\frac{\partial u}{\partial x} \bigg|_{x = 0} \simeq \frac{u_0^n - u_{-1}^n}{h} = 0$

$$
\begin{cases} 
u_{-1}^n = u_0^n \\
u_N^n = u_{N-1}^n 
\end{cases}
$$

$i = 0$

$\frac{u_i^{n+1} - u_i^n}{\tau} + \frac{u_i^n - u_{i+1}^n}{h^2} = 0$

$i = N - 1$

$\frac{u_i^{n+1} - u_i^n}{\tau} + \frac{u_{i-1}^n - u_i^n}{h^2} = 0$

---

**Forme matricielle**

$$
U^n = \begin{pmatrix} 
u_0^n \\
\vdots \\
u_{N-1}^n 
\end{pmatrix}
$$

$\frac{U^{n+1} - U^n}{\tau} + \frac{1}{h^2} A U^n = 0$

$$
A = \begin{pmatrix} 
1 & -1 & 0 & \dots&0 \\
-1 & 2 & \dots & \dots &0\\
0 & \dots & \ddots & \dots&0 \\
\dots & \dots & -1 & 2 & -1 \\
0 & \dots & 0 & -1&2
\end{pmatrix}
$$

$A$ symétrique.

$$
U^0 = \begin{pmatrix} 
u(x_0, 0) \\
\vdots \\
u(x_{N-1}, 0) 
\end{pmatrix}
$$

$U^{n+1} = \left( I - \frac{\tau}{h^2} A \right) U^n$

$\frac{U^n - U^{n-1}}{\tau} + \frac{1}{h^2} A U^n = 0$

$\left( I + \frac{\tau}{h^2} A \right) U^n = U^{n-1}$

$\left( I + \frac{\tau}{h^2} A \right) U^{n+1} = U^n$

---

Pour passer de $U^n$ à $U^{n+1}$, il faut résoudre un système linéaire.

Python + Rust  
→ utiliser les matrices avec beaucoup de "space matrix"

$A \cdot v \rightarrow N$

$\rightarrow U^{n+1} = \left( I + \frac{\tau}{h^2} A \right)^{-1} U^n$

$u$ solution exacte  
$u_i^n$ est approche  

$\sup_{i,n} |u(x_i, t_n) - u_i^n| \longrightarrow 0$  
$N,P \longrightarrow \infty$

Choisir $N, P$

$h = \frac{L}{N}$ \quad $0 \leq t_n \leq T$

$\tau = \frac{T}{P}$ \quad $0 \leq x_i \leq L$

On a *** pour le schéma explicite sous une condition (Courant-Friedrichs-Lewy, CFL) :

$\tau \leq \frac{h^2}{2}$   condition de stabilité

Le schéma explicite est inconditionnellement stable, il suffit que $\tau, h \longrightarrow 0$.