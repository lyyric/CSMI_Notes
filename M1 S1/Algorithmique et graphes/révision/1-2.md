### 多项式和矩阵运算：复杂度分析

#### 一、多项式乘法

假设有两个多项式 $P$ 和 $Q$，它们的形式如下：
$$
P = a_0 + a_1 x + \dots + a_{n-1} x^{n-1}, \quad Q = b_0 + b_1 x + \dots + b_{n-1} x^{n-1}.
$$
我们想计算它们的乘积 $P \cdot Q$，结果是一个多项式 $R = P \cdot Q$，其系数为：
$$
R = [c_0, c_1, \dots, c_{2n-2}],
$$
其中：
$$
c_k = \sum_{i=0}^k a_i b_{k-i}.
$$

#### **朴素算法**
- 直接展开两个多项式的乘法。
- 每个 $c_k$ 的计算需要 $k+1$ 次乘法。
- 总共需要：
  - $n^2$ 次乘法（每个 $a_i b_j$ 的计算），
  - $n^2 - (2n-1)$ 次加法（将中间结果累加）。

**复杂度：**
$$
\mathcal{O}(n^2).
$$

#### **卡拉茨巴（Karatsuba）算法**
卡拉茨巴方法通过“分治思想”降低了多项式乘法的复杂度。假设 $P$ 和 $Q$ 的系数个数是 2 的幂次（否则可以补 0）。将它们分为两部分：
$$
P = S x^{m} + T, \quad Q = U x^{m} + V,
$$
其中 $S, T, U, V$ 的系数个数为 $m$。那么：
$$
P \cdot Q = S \cdot U \cdot x^{2m} + ((S+T)(U+V) - S \cdot U - T \cdot V) \cdot x^m + T \cdot V.
$$

这个公式将乘法 $P \cdot Q$ 分解为 3 个子问题（分别计算 $S \cdot U, T \cdot V, (S+T)(U+V)$），以及若干加法和减法操作。

#### **复杂度分析**
对于系数数为 $n = 2^\ell$ 的多项式：
1. **每次递归分解**，将问题分为 3 个子问题，每个问题规模缩小一半。
2. 同时需要 $4 \cdot n - 4$ 次加法操作。

设 $\mathcal{C}(n)$ 是规模为 $n$ 的问题所需的运算次数，则递推关系为：
$$
\mathcal{C}(n) = 3 \mathcal{C}(n/2) + 4n.
$$
解这个递推关系可以得到：
$$
\mathcal{C}(n) = \mathcal{O}(n^{\log_2 3}),
$$
其中：
$$
\log_2 3 \approx 1.58.
$$

---

#### 二、矩阵乘法

假设有两个 $n \times n$ 的矩阵 $A$ 和 $B$，其乘积矩阵 $C = AB$ 的元素定义为：
$$
c_{ij} = \sum_{k=1}^{n} a_{ik} b_{kj}.
$$

#### **朴素算法**
直接按定义计算，每个元素 $c_{ij}$ 需要 $n$ 次乘法和 $n-1$ 次加法，总共：
- $n^3$ 次乘法，
- $n^2 \cdot (n-1)$ 次加法。

**复杂度：**
$$
\mathcal{O}(n^3).
$$

#### **Strassen 算法**
Strassen 算法通过“分治思想”优化了矩阵乘法。假设矩阵 $A$ 和 $B$ 的维度是 2 的幂次（否则可以补零）。将它们分为 4 个子矩阵：
$$
A = \begin{pmatrix} A_{11} & A_{12} \\ A_{21} & A_{22} \end{pmatrix}, \quad
B = \begin{pmatrix} B_{11} & B_{12} \\ B_{21} & B_{22} \end{pmatrix}.
$$

矩阵乘法可以按定义进行，但需要 8 次矩阵乘法和 4 次矩阵加法。而 Strassen 的改进是引入 7 个辅助矩阵：
1. $M_1 = (A_{12} - A_{22})(B_{21} + B_{22})$
2. $M_2 = (A_{11} + A_{22})(B_{11} + B_{22})$
3. $M_3 = (A_{11} - A_{21})(B_{11} + B_{12})$
4. $M_4 = (A_{11} + A_{12})B_{22}$
5. $M_5 = A_{11}(B_{12} - B_{22})$
6. $M_6 = A_{22}(B_{21} - B_{11})$
7. $M_7 = (A_{21} + A_{22})B_{11}$

然后计算最终结果：
$$
C = \begin{pmatrix}
M_1 + M_2 - M_4 + M_6 & M_4 + M_5 \\
M_6 + M_7 & M_2 - M_3 + M_5 - M_7
\end{pmatrix}.
$$

#### **复杂度分析**
对于矩阵大小为 $n \times n$ 的问题，Strassen 算法每次分解成 7 个子问题，每个子问题规模为 $n/2$。加法操作的复杂度为 $18(n/2)^2 = 4.5n^2$。

设 $\mathcal{C}(n)$ 是问题规模为 $n$ 的计算成本，则递推关系为：
$$
\mathcal{C}(n) = 7 \mathcal{C}(n/2) + 4.5n^2.
$$
解这个关系可以得到：
$$
\mathcal{C}(n) = \mathcal{O}(n^{\log_2 7}),
$$
其中：
$$
\log_2 7 \approx 2.81.
$$

---

### 结论

- **多项式乘法**：使用 Karatsuba 算法，复杂度降低到 $\mathcal{O}(n^{\log_2 3}) \approx \mathcal{O}(n^{1.58})$。
- **矩阵乘法**：使用 Strassen 算法，复杂度降低到 $\mathcal{O}(n^{\log_2 7}) \approx \mathcal{O}(n^{2.81})$。

这两种优化都利用了“分治思想”，通过减少乘法次数（相对昂贵）来提高整体效率。