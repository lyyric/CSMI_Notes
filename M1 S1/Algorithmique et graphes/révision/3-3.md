### **图论：二分图、邻接矩阵、图的着色与路径算法**

---

#### **五、二分图 (Bipartite Graph)**

**定义：**  
如果一个图 $G = (S, A)$ 的顶点集合 $S$ 可以划分为两个互不相交的子集 $S_1$ 和 $S_2$，使得每条边都连接 $S_1$ 和 $S_2$ 中的顶点，称 $G$ 为**二分图**。

**例子：**  
- 没有奇数长度环的图是二分图。
- $C_{2n}$（偶数长度的循环图）是二分图。

**定理：**  
一个图是二分图，当且仅当它不包含奇数长度的环。

**证明：**

1. **必要性：**  
如果 $G$ 是二分图，将其顶点划分为 $S_1, S_2$，考虑一个环的顶点顺序 $s_0, s_1, \ldots, s_l$。  
根据定义，顶点在 $S_1$ 和 $S_2$ 中交替出现。由于环的起点和终点相同，顶点数 $l$ 必须为偶数，因此 $G$ 没有奇数长度环。

2. **充分性：**  
假设 $G$ 没有奇数长度环。任选一个顶点 $s_0$，定义：  
$S_1 = \{s \mid d(s_0, s) \text{为奇数}\}$，  
$S_2 = \{s \mid d(s_0, s) \text{为偶数}\}$。  
若存在 $S_1$ 或 $S_2$ 内的边，则构成奇数环，与假设矛盾，因此 $G$ 是二分图。

**性质：**  
- 所有树都是二分图，因为树不含环。
- 若 $G$ 是二分图，且 $S_1$ 和 $S_2$ 为其顶点划分，则 $G$ 可以用邻接矩阵表示为分块对称形式。

---

#### **六、邻接矩阵 (Adjacency Matrix)**

**定义：**  
对于一个图 $G$ ，顶点集合 $\{A_1, A_2, \ldots, A_n\}$，其邻接矩阵 $A_G = (a_{ij})$ 定义如下：
$$
a_{ij} =
\begin{cases} 
1 & \text{如果 } A_i \text{ 与 } A_j \text{ 有边相连}, \\ 
0 & \text{否则}.
\end{cases}
$$

**性质：**  
1. $A_G$ 是对称矩阵（无向图）。
2. 主对角线全为 0（简单图没有自环）。
3. $A_G^m = (a_{ij}^{(m)})$ 的元素 $a_{ij}^{(m)}$ 表示从 $A_i$ 到 $A_j$ 长度为 $m$ 的路径数量。

**图的连通性：**  
通过计算：
$$
A_G + A_G^2 + \cdots + A_G^n
$$
如果结果中所有元素均 $\geq 1$，则图 $G$ 是连通的。

---

#### **七、图的着色 (Graph Coloring)**

**定义：**  
图 $G$ 的**色数**（chromatic number），记作 $\chi(G)$，是将图的顶点染色所需的最少颜色数，要求相邻顶点颜色不同。

**性质：**
1. $\chi(K_n) = n$（完全图需要 $n$ 种颜色）。
2. $\chi(C_n)$ （循环图）：  
   - $\chi(C_n) = 2$（当 $n$ 为偶数时）。  
   - $\chi(C_n) = 3$（当 $n$ 为奇数时）。

**上界：**  
对于一个图 $G$，有：
$$
\chi(G) \leq 1 + \max d(a),
$$
其中 $\max d(a)$ 是图中最大度数。

**证明：**  
使用贪心算法依次为每个顶点染色，每个顶点的颜色至多为其邻接顶点数加 1。

---

#### **八、路径算法**

**1. Dijkstra 算法：最短路径（无负权）**

**目标：**  
求从起点 $s$ 到所有其他顶点的最短路径。  
**初始化：**  
$d[s] = 0$，其他点的初始距离 $d[v] = +\infty$。  
**主要步骤：**  
每次选择当前距离最短的顶点 $u$，更新其所有邻接顶点 $v$ 的最短路径值（称为**松弛操作**）：
$$
d[v] = \min(d[v], d[u] + \omega(u, v)).
$$

**复杂度：**  
- 找最短顶点：$O(|S|^2)$（如果使用堆优化，则可降为 $O((|S| + |A|) \log |S|)$）。  

---

**2. Bellman-Ford 算法：最短路径（允许负权）**

**目标：**  
求起点 $s$ 到所有点的最短路径，允许负权值但不允许负权环。  
**主要步骤：**  
重复松弛每条边 $|S| - 1$ 次。  
最后一轮检测是否存在负权环：
$$
\text{若 } d[v] > d[u] + \omega(u, v), \text{ 则存在负权环。}
$$

**复杂度：**  
$O(|S| \cdot |A|)$。  

---

**总结：**  
- 二分图判定：检查奇环。
- 邻接矩阵：分析路径数量、判断连通性。
- 图的着色：贪心算法提供上界。
- 最短路径：Dijkstra 适合非负权图，Bellman-Ford 可处理负权。